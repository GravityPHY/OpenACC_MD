# OpenMP MD

## How to compile
```
g++ -std=c++11 -fopenmp OMP_MD_vector.cpp -o OMP_MD_vector
OMP_NUM_THREADS=4 ./OMP_MD_vector
```

## Basic MD

### OMP_MD_basic_v0
fully implemented **very bad performance**

### OMP_MD_basic_v1
update `calcVerlet` 

### OMP_MD_basic_v2
update `calcAccel`


## Neighborhood with vector

### OMP_MD_vector_v0
For comparison

### OMP_MD_vector_v1
fully implemented with omp parallel clause, not fine tuned.

### ~~OMP_MD_vector_v2~~ **deprecated** 
~~final version~~ 

data result: 

| L    | np   | 1    | 2    | 4    | 8    | 16   | 
|------|------|------|------|------|------|------|
|64    |64    |0.47878376|0.377148343|0.372746554|0.429837683|0.48495589|
|      |128   |1.847976344|1.134697654|0.956766383|0.777583345|0.782326381|
|      |256   |7.147095021|4.497076088|2.797208179|2.253166442|1.99271713|
|      |512   |28.783580862|18.124845884|9.618808516|5.965392881|4.243118874|
|128   |128   |1.334958096|0.894949861|0.704597455|0.613159713|0.698897277|
|      |256   |5.34482324|3.13247733|1.931456682|1.876773731|1.738029761|
|      |512   |20.84896922|12.898651051|7.098345956|4.590486369|3.499529336|
|      |1024  |82.101149166|48.91325651|25.131638661|14.020853522|8.535498132|
|256   |256   |4.531546642|2.318951403|1.86372693|1.681474746|1.633219584|
|      |512   |17.945409165|10.374174059|6.149046839|4.205575331|3.155660214|
|      |1024  |70.679522295|38.610905872|22.040908397|12.713775165|7.800162771|
|      |2048  |284.568302196|150.136077656|82.719277239|42.560098573|23.628369235|
|      |4096  |1142.414023005|598.999013|318.085554837|165.174650572|84.219420654|
|512   |512   |16.758234626|8.865179005|5.972666627|3.99665798|3.214189716|
|      |1024  |66.217876943|34.07163675|21.110742785|11.581873345|7.757724698|
|      |2048  |264.700392812|134.626257365|78.236059859|40.100275382|23.236195909|
|      |4096  |1063.977918004|539.174075036|297.234731589|147.946676395|78.995807392|
|      |8192  |4245.15053262|2117.964584861|1085.036455755|571.753400088|287.33511735|
|1024  |1024  |64.984694487|33.042102252|20.026664824|11.438993701|7.530271853|
|      |2048  |258.003763751|131.056341909|72.972602199|39.540227558|21.998210606|
|      |4096  |1022.870339486|535.39201369|283.309959015|149.127658804|74.83412329|
|      |8192  |4078.491357335|2068.315010458|1100.195738936|561.580696775|288.86252223|
|      |16384 |16275.190270335|8151.566852157|4245.007864962|2224.315245165|1104.189243976|
|2048  |2048  |248.9620306|142.777476727|70.305548958|37.959935229|21.133626077|
|      |4096  |999.576284011|526.986318189|264.257248414|139.202678692|73.488625578|
|      |8192  |3989.084080649|2004.025373987|1026.535528506|540.27385761|271.350939544|
|      |16384 |15956.605043583|8009.35156591|4105.448799259|2163.297445277|1115.042069256|
|4096  |4096  |989.24635456|528.498519729|265.0651471|139.134409949|73.805171212|
|      |8192  |3953.362561162|2009.290547843|1014.062948055|535.268092976|268.800710967|
|      |16384 |15786.834208298|7992.484435364|4057.701719598|2145.319107067|1073.528508838|


### OMP_MD_vector_v3
Fixed one bug related to R_skin and R_cut

**Current Best Version**

### OMP_MD_vector_v4
- update `calcVerlet` 
- result is not as good as v3